{"version":3,"sources":["../../../../server/api/image-upload/image-uploads.controller.js"],"names":[],"mappings":";;;;AAIA;;;;;QAoCgB;;AAlChB;;;;;;AAEA,qBAAW,MAAX,CAAkB;AACd,gBAAY,QAAQ,GAAR,CAAY,UAAZ;AACZ,aAAS,QAAQ,GAAR,CAAY,aAAZ;AACT,gBAAY,QAAQ,GAAR,CAAY,gBAAZ;CAHhB;;AAMA,SAAS,iBAAT,CAA2B,GAA3B,EAAgC,GAAhC,EAAqC,IAArC,EAA2C;;;AAGvC,QAAI,IAAI,IAAJ,CAAS,IAAT,EAAe;;AAEf,gBAAQ,GAAR,CAAY,WAAZ,EAFe;AAGf,2BAAmB,IAAI,IAAJ,CAAS,IAAT,EAAe,GAAlC,EAAuC,IAAvC,EAHe;KAAnB,MAIO;AACH,2BAAmB,IAAI,KAAJ,CAAU,IAAV,CAAe,IAAf,EAAqB,GAAxC,EAA6C,IAA7C,EADG;KAJP;CAHJ;;AAYA,SAAS,kBAAT,CAA4B,QAA5B,EAAsC,GAAtC,EAA2C,IAA3C,EAAiD;AAC7C,yBAAW,QAAX,CAAoB,MAApB,CAA2B,QAA3B,EAAqC,UAAC,MAAD,EAAY;AAC7C,YAAI,OAAO,GAAP,EAAY;AACZ,oBAAQ,GAAR,CAAY,wCAAZ;;AADY,eAGZ,CAAI,IAAJ,CAAS,MAAT,EAHY;AAIZ,mBAJY;SAAhB,MAKO;AACH,oBAAQ,GAAR,CAAY,sBAAZ,EADG;AAEH,gBAAI,IAAJ,CAAS,KAAT,EAFG;SALP;KADiC,CAArC,CAD6C;CAAjD;;AAcO,SAAS,MAAT,CAAgB,GAAhB,EAAqB,GAArB,EAA0B,IAA1B,EAAgC;AACnC,sBAAkB,GAAlB,EAAuB,GAAvB,EAA4B,IAA5B,EADmC;AAEnC,YAAQ,GAAR,CAAY,mBAAZ,EAAiC,QAAQ,GAAR,CAAY,UAAZ,CAAjC,CAFmC;CAAhC","file":"image-uploads.controller.js","sourcesContent":["/*\n *POST /api/upload-image\n */\n\n'use strict';\n\nimport cloudinary from 'cloudinary'\n\ncloudinary.config({\n    cloud_name: process.env.CLOUD_NAME,\n    api_key: process.env.CLOUD_API_KEY,\n    api_secret: process.env.CLOUD_API_SECRET\n})\n\nfunction uploadFileToCloud(req, res, next) {\n\n    // Check first if the image is from the web\n    if (req.body.file) {\n        // This means the image is from instagram\n        console.log('web photo')\n        uploadToCloudinary(req.body.file, res, next)\n    } else {\n        uploadToCloudinary(req.files.file.path, res, next)\n    }\n}\n\nfunction uploadToCloudinary(filePath, res, next) {\n    cloudinary.uploader.upload(filePath, (result) => {\n        if (result.url) {\n            console.log('This image already exists in the Cloud')\n                // req.imageLink = result.url\n            res.json(result)\n            next()\n        } else {\n            console.log('Something went wrong')\n            res.json(error)\n        }\n    })\n}\n\nexport function upload(req, res, next) {\n    uploadFileToCloud(req, res, next)\n    console.log('the cloud name is', process.env.CLOUD_NAME)\n}\n"]}